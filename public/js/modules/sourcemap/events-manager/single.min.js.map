{"version":3,"sources":["single.js"],"names":["$","document","ready","Unicamp_Event_Frontend","init","clock","clockSettings","daysText","hoursText","minutesText","secondsText","$eventCountdown","length","valueDate","data","time","$unicamp","countdownDaysText","countdownHoursText","countdownMinutesText","countdownSecondsText","countdown","event","timeTemplate","offset","totalDays","this","html","strftime","$doc","on","load_form_register","book_event_form","ajax_login","e","preventDefault","$button","eventID","attr","ajax","url","WPEMS","ajaxurl","type","dataType","event_id","nonce","register_button","action","beforeSend","addClass","success","lightbox","complete","removeClass","_self","_data","serializeArray","button","find","_notices","slideUp","remove","done","res","status","window","location","href","magnificPopup","close","hide","setTimeout","append","woo_cart_url","add_to_cart","message","set_message","something_wrong","fail","always","form","sanitize_form_field","_form_fields","i","_this","_form_row","parents","hasClass","val","content","push","open","items","src","join","mainClass","callbacks","timeout","clearTimeout","_button","_lightbox","async","notices","before","redirect","reload","jqXHR","textStatus","errorThrown","jQuery"],"mappings":"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","file":"../../../events-manager/single.min.js","sourcesContent":["(\n\tfunction( $ ) {\n\t\t'use strict';\n\n\t\t$( document ).ready( function() {\n\t\t\tUnicamp_Event_Frontend.init();\n\n\t\t\tvar $eventCountdown = $( '#entry-event-countdown' );\n\t\t\tif ( $eventCountdown.length > 0 ) {\n\t\t\t\tvar clock = $eventCountdown;\n\n\t\t\t\tvar clockSettings = clock.data(),\n\t\t\t\t    valueDate     = clockSettings.time,\n\t\t\t\t    daysText      = clockSettings.daysText ? clockSettings.daysText : $unicamp.countdownDaysText,\n\t\t\t\t    hoursText     = clockSettings.hoursText ? clockSettings.hoursText : $unicamp.countdownHoursText,\n\t\t\t\t    minutesText   = clockSettings.minutesText ? clockSettings.minutesText : $unicamp.countdownMinutesText,\n\t\t\t\t    secondsText   = clockSettings.secondsText ? clockSettings.secondsText : $unicamp.countdownSecondsText;\n\n\t\t\t\tclock.countdown( valueDate, function( event ) {\n\t\t\t\t\tvar timeTemplate = '<div class=\"countdown-section hour\"><span class=\"countdown-amount\">%H</span><span class=\"countdown-period\">' + hoursText + '</span></div>' +\n\t\t\t\t\t                   '<div class=\"countdown-section minute\"><span class=\"countdown-amount\">%M</span><span class=\"countdown-period\">' + minutesText + '</span></div>' +\n\t\t\t\t\t                   '<div class=\"countdown-section second\"><span class=\"countdown-amount\">%S</span><span class=\"countdown-period\">' + secondsText + '</span></div>';\n\n\t\t\t\t\tif ( event.offset.totalDays > 0 ) {\n\t\t\t\t\t\ttimeTemplate = '<div class=\"countdown-section day\"><span class=\"countdown-amount\">%D</span><span class=\"countdown-period\">' + daysText + '</span></div>' + timeTemplate;\n\t\t\t\t\t}\n\n\t\t\t\t\ttimeTemplate = '<div class=\"countdown-row\">' + timeTemplate + '</div>'; // wrapper.\n\n\t\t\t\t\t$( this ).html( event.strftime( timeTemplate ) );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\tvar Unicamp_Event_Frontend = {\n\t\t\tinit: function() {\n\t\t\t\tvar $doc = $( document );\n\n\t\t\t\t$doc.on( 'click', '.event-load-booking-form', this.load_form_register );\n\n\t\t\t\t/**\n\t\t\t\t * load register form\n\t\t\t\t */\n\t\t\t\t$doc.on( 'submit', 'form.event_register:not(.active)', this.book_event_form );\n\n\t\t\t\t/**\n\t\t\t\t * Sanitize form field\n\t\t\t\t */\n\t\t\t\t//this.sanitize_form_field();\n\n\t\t\t\t$doc.on( 'submit', '#event-lightbox .event-auth-form', this.ajax_login );\n\t\t\t},\n\t\t\tload_form_register: function( e ) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar $button = $( this ),\n\t\t\t\t    eventID = $button.attr( 'data-event' );\n\n\t\t\t\t$.ajax( {\n\t\t\t\t\turl: WPEMS.ajaxurl,\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdataType: 'html',\n\t\t\t\t\t//async: false,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tevent_id: eventID,\n\t\t\t\t\t\tnonce: WPEMS.register_button,\n\t\t\t\t\t\taction: 'load_form_register'\n\t\t\t\t\t},\n\t\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t\t$button.addClass( 'updating-icon' );\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function( html ) {\n\t\t\t\t\t\tUnicamp_Event_Frontend.lightbox( html );\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t$button.removeClass( 'updating-icon' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t},\n\t\t\t/**\n\t\t\t * Ajax action register form\n\t\t\t * @returns boolean\n\t\t\t */\n\t\t\tbook_event_form: function( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar _self    = $( this ),\n\t\t\t\t    _data    = _self.serializeArray(),\n\t\t\t\t    button   = _self.find( 'button[type=\"submit\"]' ),\n\t\t\t\t    _notices = _self.find( '.tp-event-notice' );\n\n\t\t\t\t$.ajax( {\n\t\t\t\t\turl: WPEMS.ajaxurl,\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: _data,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t\t_notices.slideUp().remove();\n\t\t\t\t\t\tbutton.addClass( 'event-register-loading' );\n\t\t\t\t\t\t_self.addClass( 'active' );\n\t\t\t\t\t}\n\t\t\t\t} ).done( function( res ) {\n\t\t\t\t\tbutton.removeClass( 'event-register-loading' );\n\t\t\t\t\tif ( typeof res.status === 'undefined' ) {\n\t\t\t\t\t\tUnicamp_Event_Frontend.set_message( _self, WPEMS.something_wrong );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( res.status === true && typeof res.url !== 'undefined' && res.url !== '' ) {\n\t\t\t\t\t\twindow.location.href = res.url;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( res.status === true && res.url == '' && typeof res.event !== 'undefined' ) {\n\t\t\t\t\t\t$.magnificPopup.close();\n\t\t\t\t\t\t$( '.woocommerce-message' ).hide();\n\t\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t\t$( '.entry-register, .event_register_foot' ).append(\n\t\t\t\t\t\t\t\t'<div class=\"woocommerce-message\">' +\n\t\t\t\t\t\t\t\tWPEMS.woo_cart_url +\n\t\t\t\t\t\t\t\t'<p>' + '“' + res.event + '”' + WPEMS.add_to_cart + '</p>' +\n\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}, 100 );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( typeof res.message !== 'undefined' ) {\n\t\t\t\t\t\tUnicamp_Event_Frontend.set_message( _self, res.message );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t} ).fail( function() {\n\t\t\t\t\tbutton.removeClass( 'event-register-loading' );\n\t\t\t\t\tUnicamp_Event_Frontend.set_message( _self, WPEMS.something_wrong );\n\t\t\t\t\treturn;\n\t\t\t\t} ).always( function() {\n\t\t\t\t\t_self.removeClass( 'active' );\n\t\t\t\t} );\n\t\t\t\t// button.removeClass('event-register-loading');\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tset_message: function( form, message ) {\n\t\t\t\tvar html = '<div class=\"tp-event-notice error\">';\n\t\t\t\thtml += '<div class=\"event_auth_register_message_error\">' + message + '</div>';\n\t\t\t\thtml += '</div>';\n\t\t\t\tform.find( '.event_register_foot' ).append( html );\n\t\t\t},\n\t\t\t/**\n\t\t\t * sanitize form field\n\t\t\t * @returns null\n\t\t\t */\n\t\t\tsanitize_form_field: function() {\n\t\t\t\tvar _form_fields = $( '.form-row.form-required' );\n\n\t\t\t\tfor ( var i = 0; i < _form_fields.length; i ++ ) {\n\t\t\t\t\tvar field = $( _form_fields[ i ] ),\n\t\t\t\t\t    input = field.find( 'input' );\n\n\t\t\t\t\tinput.on( 'blur', function( e ) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tvar _this     = $( this ),\n\t\t\t\t\t\t    _form_row = _this.parents( '.form-row:first' );\n\t\t\t\t\t\tif ( ! _form_row.hasClass( 'form-required' ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( _this.val() == '' ) {\n\t\t\t\t\t\t\t_form_row.removeClass( 'validated' ).addClass( 'has-error' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_form_row.removeClass( 'has-error' ).addClass( 'validated' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t},\n\t\t\tlightbox: function( content ) {\n\t\t\t\tvar html = [];\n\t\t\t\thtml.push( '<div id=\"event-lightbox\">' );\n\t\t\t\thtml.push( content );\n\t\t\t\thtml.push( '</div>' );\n\n\t\t\t\t$.magnificPopup.open( {\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'inline',\n\t\t\t\t\t\tsrc: $( html.join( '' ) )\n\t\t\t\t\t},\n\t\t\t\t\tmainClass: 'event-lightbox-wrap',\n\t\t\t\t\tcallbacks: {\n\t\t\t\t\t\topen: function() {\n\t\t\t\t\t\t\tvar lightbox = $( '#event-lightbox' );\n\n\t\t\t\t\t\t\tlightbox.addClass( 'event-fade' );\n\t\t\t\t\t\t\tvar timeout = setTimeout( function() {\n\t\t\t\t\t\t\t\tlightbox.addClass( 'event-in' );\n\t\t\t\t\t\t\t\tclearTimeout( timeout );\n\t\t\t\t\t\t\t\tUnicamp_Event_Frontend.sanitize_form_field();\n\t\t\t\t\t\t\t}, 100 );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclose: function() {\n\t\t\t\t\t\t\tvar lightbox = $( '#event-lightbox' );\n\t\t\t\t\t\t\tlightbox.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t},\n\t\t\tajax_login: function( e ) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar _this     = $( this ),\n\t\t\t\t    _button   = _this.find( '#wp-submit' ),\n\t\t\t\t    _lightbox = $( '#event-lightbox' ),\n\t\t\t\t    _data     = _this.serializeArray();\n\n\t\t\t\t$.ajax( {\n\t\t\t\t\turl: WPEMS.ajaxurl,\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: _data,\n\t\t\t\t\tasync: false,\n\t\t\t\t\tbeforeSend: function() {\n//                    setTimeout( function(){\n\t\t\t\t\t\t_lightbox.find( '.tp-event-notice' ).slideUp().remove();\n//                    } );\n\t\t\t\t\t\t_button.addClass( 'event-register-loading' );\n\t\t\t\t\t}\n\t\t\t\t} ).always( function() {\n\t\t\t\t\t_button.find( '.event-icon-spinner2' ).remove();\n\t\t\t\t} ).done( function( res ) {\n\t\t\t\t\tif ( typeof res.notices !== 'undefined' ) {\n\t\t\t\t\t\t_this.before( res.notices );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( typeof res.status !== 'undefined' && res.status === true ) {\n\t\t\t\t\t\tif ( typeof res.redirect !== 'undefined' && res.redirect ) {\n\t\t\t\t\t\t\twindow.location.href = res.redirect;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} ).fail( function( jqXHR, textStatus, errorThrown ) {\n\t\t\t\t\tvar html = '<ul class=\"tp-event-notice error\">';\n\t\t\t\t\thtml += '<li>' + jqXHR + '</li>';\n\t\t\t\t\thtml += '</ul>';\n\t\t\t\t\t_this.before( res.notices );\n\t\t\t\t} );\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t}\n)( jQuery );\n"]}